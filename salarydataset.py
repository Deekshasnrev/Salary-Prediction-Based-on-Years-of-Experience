# -*- coding: utf-8 -*-
"""SalaryDataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1KF31kCp5KDxlL-tqHqO87U6gynTXn_CO
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')

from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error,r2_score,mean_absolute_error

df=pd.read_csv('Salary_Data.csv')
df.head()

df.shape

df.info()

df.describe()

df.isnull().sum()

plt.figure()
sns.scatterplot(data=df,x="YearsExperience",y="Salary")
plt.show()

plt.figure()
sns.heatmap(df.corr(),annot=True)
plt.show()

x=df['YearsExperience']
y=df['Salary']

x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=0.3,random_state=1)

lr=LinearRegression()

lr.fit(np.array(x_train).reshape(-1,1),y_train)

lr.intercept_

lr.coef_

y_pred=lr.predict(np.array(x_train).reshape(-1,1))
y_pred

plt.figure()
plt.plot(x_train,y_pred)
plt.show()

y_pred=lr.predict(np.array(x_test).reshape(-1,1))
y_pred

mse=mean_squared_error(y_test,y_pred)
rmse=np.sqrt(mse)
mae=mean_absolute_error(y_test,y_pred)
print(mse)
print(rmse)
print(mae)

r2=r2_score(y_test,y_pred)
r2